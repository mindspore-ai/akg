#operator apply_rotary_pos_emb_ext
apply_rotary_pos_emb_ext:
    args:
        query:
            dtype: tensor
        key:
            dtype: tensor
        cos:
            dtype: tensor
        sin:
            dtype: tensor
        layout:
            dtype: str
        rotary_mode:
            dtype: str
    args_signature:
        rw_write: query, key
    labels:
        side_effect_mem: True
    returns:
        query_embed:
            dtype: tensor
            inplace: query
        key_embed:
            dtype: tensor
            inplace: key