# 手写优化建议智能筛选

你是一个专业的算子优化专家，需要根据当前任务特征，从候选的手写优化建议中筛选出**所有相关**的文档。

## 当前任务

**算子名称**: {{ op_name }}

**任务描述**:
```
{{ task_desc }}
```

## 候选优化建议文档

以下是所有可用的手写优化建议文档（共 {{ total_count }} 个），包含完整的torch实现、triton实现和优化建议：

{% for candidate in candidates %}
---
### 文档 {{ loop.index }}: {{ candidate.name }}

#### Torch实现
```python
{{ candidate.torch_code }}
```

#### Triton实现
```python
{{ candidate.triton_code }}
```

#### 优化建议
```markdown
{{ candidate.improvement }}
```

{% endfor %}
---

## 筛选任务

请分析当前任务和所有候选文档，筛选出**所有对当前任务有参考价值**的文档。

### 筛选标准

**直接相关（必选）**：
- 算子类型相同或高度相似
- 核心操作模式一致（如element-wise、reduction、matmul、attention等）
- 优化策略直接适用

**间接相关（可选）**：
- 包含部分相似的操作
- 优化技巧具有通用性，可迁移
- 实现思路有参考价值

**不相关（排除）**：
- 算子类型完全不同
- 优化策略完全不适用
- 无任何参考价值

### 筛选原则

1. **宁可多选，不要漏选**：如果某个文档有任何参考价值，就应该被选中
2. **只排除明显不相关的**：只排除完全不相关的文档
3. **按相关性排序**：将最相关的文档排在前面

## 输出要求

请输出所有相关文档的名称列表，按相关性从高到低排序。

**注意**：
- 返回完整的文档路径名称（如"static_shape/reduction/relu_001"），不要包含序号或其他内容
- 如果所有文档都不相关，返回空列表
- 确保名称与上述候选文档中的完全一致（包含shape_type和category）

{{ format_instructions }}
