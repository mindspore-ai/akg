# 规则补充（如果与其他有冲突，以本章节内容为准）

## 常见错误避免

2. **忽略内存层次**：明确数据在不同内存层次间的移动
3. **错误的优化时机**：先保证正确性，再进行优化
4. **不恰当的批处理**：考虑算子输入大小，合理划分批处理大小
5. **尝试实现双缓存机制**：双缓存会在后续编译器流程实现，aul代码设计不需要考虑这部分
6. **不同大小的张量进行运算**：计算前根据预先申请的Tile，核验Tensor的大小
7. **涉及reduce操作的维度进行切分**：注意切分循环的维度，尽量不要切分涉及reduce操作的轴
8. **广播机制**：AUL不支持广播机制，需要注意操作的张量的大小
9. **切分方法**：如果数据大小超过存储限制，需要再次切分，保证切分与核间切分是同一个轴，例如核间并行切了第二个轴，for循环也切第二个轴
10. **不支持语法**：AUL不支持.shape操作，请显式的写出shape
11. **未标记核数**：需要在host侧设定core_num，并使用[core_num]进行标记；需要在kernel前使用@sub_kernel指定

---

## 实用指南：AUL代码生成最佳实践

### 转换步骤

1. **理解任务**：完全理解算子执行的功能逻辑
2. **设计基础算法**：使用通用AUL设计基础算法流程
3. **添加硬件优化**：基于目标硬件特性添加优化，例如流水线
4. **验证代码**：检查是否符合AUL语法规范

---

## 检查清单

- [ ] 函数签名正确，包含必要参数
- [ ] 内存操作明确指定源和目标位置
- [ ] 优化使用适当，如多核并行
- [ ] 没有使用未定义的操作或语法
- [ ] 代码结构清晰，逻辑正确
